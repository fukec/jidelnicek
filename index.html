<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stravovací deník - Zadání</title>
  <meta name="description" content="Webový formulář pro zadávání denních přehledů stravy" />
  <meta name="author" content="Stravovací poradce" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />

  <style>
    :root {
      --primary-color: #28a745;
      --secondary-color: #6c757d;
      --success-color: #20c997;
      --danger-color: #dc3545;
      --warning-color: #ffc107;
      --info-color: #17a2b8;
      --light-color: #f8f9fa;
      --dark-color: #343a40;
    }

    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      padding: 20px 0;
    }

    .main-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      max-width: 1000px;
      margin: 0 auto;
      overflow: hidden;
    }

    .header-section {
      background: linear-gradient(135deg, var(--primary-color), var(--success-color));
      color: white;
      padding: 2rem;
      text-align: center;
      position: relative;
    }

    .header-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><defs><pattern id="grain" width="100" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="white" opacity="0.1"/><circle cx="90" cy="15" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="5" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="20" fill="url(%23grain)"/></svg>');
      opacity: 0.3;
    }

    .header-section h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      position: relative;
      z-index: 1;
    }

    .client-info {
      background: rgba(255, 255, 255, 0.2);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      display: inline-block;
      margin-top: 1rem;
      position: relative;
      z-index: 1;
    }

    .form-section {
      padding: 2rem;
    }

    .date-section {
      background: var(--light-color);
      border-radius: 15px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border: 2px solid #e9ecef;
    }

    .entries-container {
      min-height: 200px;
    }

    .entry-card {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 15px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
      position: relative;
      overflow: visible; /* změněno, aby se nezablokoval výběr */
    }

    .entry-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(180deg, var(--primary-color), var(--success-color));
      transition: width 0.3s ease;
      pointer-events: none; /* klíčová oprava, aby pseudo-element neblokoval klikání */
    }

    .entry-card:hover {
      border-color: var(--primary-color);
      box-shadow: 0 8px 25px rgba(40, 167, 69, 0.15);
      transform: translateY(-2px);
    }

    .entry-card:hover::before {
      width: 100%;
      opacity: 0.05;
    }

    .entry-number {
      position: absolute;
      top: -10px;
      right: 15px;
      background: linear-gradient(135deg, var(--primary-color), var(--success-color));
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.8rem;
    }

    .form-control,
    .form-select {
      border: 2px solid #e9ecef;
      border-radius: 10px;
      padding: 0.75rem 1rem;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      position: relative;
      z-index: 1; /* zajistí, že vstupy jsou nad ::before */
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.25rem rgba(40, 167, 69, 0.15);
      outline: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-color), var(--success-color));
      border: none;
      border-radius: 25px;
      padding: 1rem 2rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
    }

    .btn-secondary {
      border-radius: 25px;
      padding: 0.75rem 1.5rem;
      font-weight: 500;
    }

    .btn-outline-danger {
      border-radius: 10px;
      border-width: 2px;
    }

    .action-buttons {
      background: var(--light-color);
      padding: 2rem;
      border-top: 1px solid #dee2e6;
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      backdrop-filter: blur(5px);
    }

    .loading-content {
      background: white;
      border-radius: 20px;
      padding: 3rem;
      text-align: center;
      max-width: 300px;
    }

    .spinner-border {
      width: 3rem;
      height: 3rem;
      color: var(--primary-color);
    }

    .alert {
      border-radius: 15px;
      border: none;
      padding: 1rem 1.5rem;
      margin-top: 1rem;
    }

    .alert-success {
      background: linear-gradient(135deg, #d4edda, #c3e6cb);
      color: #155724;
    }

    .alert-danger {
      background: linear-gradient(135deg, #f8d7da, #f5c6cb);
      color: #721c24;
    }

    .navigation-links {
      text-align: center;
      margin-top: 1rem;
    }

    .navigation-links a {
      color: white;
      text-decoration: none;
      margin: 0 1rem;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .navigation-links a:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-1px);
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      .main-container {
        margin: 0 10px;
        border-radius: 15px;
      }

      .header-section {
        padding: 1.5rem 1rem;
      }

      .header-section h1 {
        font-size: 1.8rem;
      }

      .form-section {
        padding: 1rem;
      }

      .entry-card {
        padding: 1rem;
      }

      .action-buttons {
        padding: 1rem;
        flex-direction: column;
      }

      .action-buttons .btn {
        width: 100%;
        justify-content: center;
      }

      .navigation-links {
        flex-direction: column;
        gap: 0.5rem;
      }

      .navigation-links a {
        display: block;
        margin: 0.25rem 0;
      }
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .entry-card.new-entry {
      animation: slideInUp 0.5s ease-out;
    }

    .text-gradient {
      background: linear-gradient(135deg, var(--primary-color), var(--success-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .shadow-soft {
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <div class="main-container">
    <!-- Hlavička -->
    <div class="header-section">
      <h1><i class="bi bi-journal-text me-2"></i>Stravovací deník</h1>
      <p class="mb-0 opacity-90">Zadání denních přehledů stravy</p>
      <div class="client-info" id="client-info">
        <i class="bi bi-person-circle me-1"></i>
        <span id="client-name">Načítám...</span>
      </div>
      <div class="navigation-links">
        <a href="#" id="mydata-link">
          <i class="bi bi-graph-up me-1"></i>Týdenní přehled
        </a>
        <a href="admin.html">
          <i class="bi bi-gear me-1"></i>Admin panel
        </a>
      </div>
    </div>

    <!-- Formulář -->
    <div class="form-section">
      <form id="food-form" novalidate>
        <!-- Sekce data -->
        <div class="date-section">
          <div class="row align-items-end">
            <div class="col-md-6">
              <label for="datum" class="form-label fw-bold">
                <i class="bi bi-calendar3 me-2 text-primary"></i>Datum záznamu
              </label>
              <input type="date" id="datum" class="form-control form-control-lg" required />
              <div class="invalid-feedback">Prosím vyberte datum.</div>
            </div>
            <div class="col-md-6 mt-3 mt-md-0">
              <div class="d-grid gap-2 d-md-flex">
                <button type="button" class="btn btn-outline-secondary flex-fill" id="today-btn">
                  <i class="bi bi-calendar-check me-1"></i>Dnes
                </button>
                <button type="button" class="btn btn-outline-secondary flex-fill" id="yesterday-btn">
                  <i class="bi bi-calendar-minus me-1"></i>Včera
                </button>
                <button type="button" class="btn btn-outline-danger" id="clear-form-btn">
                  <i class="bi bi-arrow-clockwise me-1"></i>Vymazat
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Položky stravy -->
        <div class="entries-container">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h4 class="text-gradient mb-0">
              <i class="bi bi-plus-circle me-2"></i>Položky stravy
            </h4>
            <span class="badge bg-primary" id="items-counter">0 položek</span>
          </div>
          <div id="entries">
            <!-- Zde se budou přidávat položky dynamicky -->
          </div>
        </div>

        <!-- Výsledková zpráva -->
        <div id="result" class="d-none"></div>
      </form>
    </div>

    <!-- Akční tlačítka -->
    <div class="action-buttons">
      <button type="button" class="btn btn-secondary" id="add-item-btn">
        <i class="bi bi-plus-lg me-2"></i>Přidat položku
      </button>
      <button type="submit" form="food-form" class="btn btn-primary" id="submit-btn">
        <i class="bi bi-check2-circle me-2"></i>Odeslat deník
      </button>
    </div>
  </div>

  <!-- Loading overlay -->
  <div class="loading-overlay d-none" id="loading-overlay">
    <div class="loading-content">
      <div class="spinner-border mb-3" role="status">
        <span class="visually-hidden">Načítám...</span>
      </div>
      <h5>Ukládám data...</h5>
      <p class="text-muted mb-0">Prosím počkejte</p>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ===== KONFIGURACE =====
    const CONFIG = {
      API_URL:
        "https://script.google.com/macros/s/AKfycbwPd3FgeXAko_3NNqGxk_0btncpIlkg5jIAK3hFfseic0fFXyJugB-vc-s_BM2_JAAg/exec", // ⚠️ MUSÍŠ NAHRADIT!
      MEALS: [
        "Snídaně",
        "Svačina dopoledne",
        "Oběd",
        "Svačina odpoledne",
        "Večeře",
        "Jiný příjem",
        "Pitný režim",
      ],
      MAX_ITEMS: 20,
      AUTO_SAVE_INTERVAL: 30000, // 30 sekund
      DEBUG: false,
    };

    // ===== GLOBÁLNÍ PROMĚNNÉ =====
    let currentClientKey = "";
    let itemCounter = 0;
    let autoSaveTimer = null;
    let isDirty = false;

    // ===== INICIALIZACE =====
    document.addEventListener("DOMContentLoaded", function () {
      initializeApp();
    });

    function initializeApp() {
      const urlParams = new URLSearchParams(window.location.search);
      currentClientKey = urlParams.get("key") || "demo123";
      setupUI();
      setupEventListeners();
      addFoodItem();
      loadDraftData();
      if (CONFIG.DEBUG) {
        console.log("Aplikace inicializována, klient:", currentClientKey);
      }
    }

    function setupUI() {
      document.getElementById("client-name").textContent = `Klient: ${currentClientKey}`;
      document.getElementById("mydata-link").href = `mydata.html?key=${currentClientKey}`;
      const today = new Date().toISOString().split("T")[0];
      document.getElementById("datum").value = today;
      updateItemsCounter();
    }

    function setupEventListeners() {
      document.getElementById("food-form").addEventListener("submit", handleFormSubmit);
      document.getElementById("add-item-btn").addEventListener("click", addFoodItem);
      document.getElementById("clear-form-btn").addEventListener("click", clearForm);
      document.getElementById("today-btn").addEventListener("click", () => setDate(0));
      document.getElementById("yesterday-btn").addEventListener("click", () => setDate(-1));
      document.getElementById("food-form").addEventListener("input", () => {
        isDirty = true;
        startAutoSave();
      });
      document.addEventListener("keydown", handleKeyboardShortcuts);
      window.addEventListener("beforeunload", function (e) {
        if (isDirty) {
          saveDraftData();
        }
      });
    }

    function addFoodItem() {
      if (itemCounter >= CONFIG.MAX_ITEMS) {
        showAlert(`Dosáhli jste maximálního počtu položek (${CONFIG.MAX_ITEMS})`, "warning");
        return;
      }
      itemCounter++;
      const entriesContainer = document.getElementById("entries");
      const entryCard = document.createElement("div");
      entryCard.className = "entry-card new-entry";
      entryCard.setAttribute("data-item-id", itemCounter);
      entryCard.innerHTML = `
        <div class="entry-number">${itemCounter}</div>
        <div class="row g-3">
          <div class="col-lg-3 col-md-4">
            <label class="form-label fw-semibold">
              <i class="bi bi-clock me-1"></i>Druh chodu
            </label>
            <select class="form-select" name="druh_chodu" required>
              <option value="">Vyberte chod</option>
              ${CONFIG.MEALS.map((meal) => `<option value="${meal}">${meal}</option>`).join("")}
            </select>
            <div class="invalid-feedback">Vyberte druh chodu.</div>
          </div>

          <div class="col-lg-2 col-md-3 col-sm-6">
            <label class="form-label fw-semibold">
              <i class="bi bi-arrows-expand me-1"></i>Hmotnost
            </label>
            <div class="input-group">
              <input type="number" class="form-control" name="hmotnost" min="0.1" max="10000" step="0.1" placeholder="0" required />
              <span class="input-group-text">g/ml</span>
            </div>
            <div class="invalid-feedback">Zadejte hmotnost (0.1 - 10000).</div>
          </div>

          <div class="col-lg-4 col-md-5">
            <label class="form-label fw-semibold">
              <i class="bi bi-egg-fried me-1"></i>Potravina
            </label>
            <input type="text" class="form-control" name="potravina" placeholder="Název potraviny" maxlength="100" required />
            <div class="invalid-feedback">Zadejte název potraviny (max 100 znaků).</div>
          </div>

          <div class="col-lg-2 col-md-3 col-sm-6">
            <label class="form-label fw-semibold">
              <i class="bi bi-fire me-1"></i>Kalorie
            </label>
            <div class="input-group">
              <input type="number" class="form-control" name="kaloricka_hodnota" min="0" max="9999" step="1" placeholder="0" />
              <span class="input-group-text">kcal</span>
            </div>
            <div class="invalid-feedback">Zadejte kalorie (0 - 9999).</div>
          </div>

          <div class="col-lg-1 col-md-12 d-flex align-items-end">
            <button type="button" class="btn btn-outline-danger w-100" onclick="removeFoodItem(this)" title="Odebrat položku">
              <i class="bi bi-trash"></i>
              <span class="d-md-none ms-1">Odebrat</span>
            </button>
          </div>
        </div>
      `;
      entriesContainer.appendChild(entryCard);
      const firstSelect = entryCard.querySelector("select");
      setTimeout(() => firstSelect.focus(), 100);
      updateItemsCounter();
      if (CONFIG.DEBUG) {
        console.log("Přidána položka:", itemCounter);
      }
    }

    function removeFoodItem(button) {
      const entryCard = button.closest(".entry-card");
      if (document.querySelectorAll(".entry-card").length <= 1) {
        showAlert("Musí zůstat alespoň jedna položka!", "warning");
        return;
      }
      entryCard.style.animation = "slideOutUp 0.3s ease-in";
      setTimeout(() => {
        entryCard.remove();
        updateItemsCounter();
        updateEntryNumbers();
        isDirty = true;
      }, 300);
      if (CONFIG.DEBUG) {
        console.log("Odebrána položka");
      }
    }

    function updateEntryNumbers() {
      const entryCards = document.querySelectorAll(".entry-card");
      entryCards.forEach((card, index) => {
        const numberElement = card.querySelector(".entry-number");
        if (numberElement) numberElement.textContent = index + 1;
        card.setAttribute("data-item-id", index + 1);
      });
      itemCounter = entryCards.length;
    }

    function updateItemsCounter() {
      const count = document.querySelectorAll(".entry-card").length;
      document.getElementById("items-counter").textContent = `${count} položek`;
    }

    function setDate(daysOffset) {
      const date = new Date();
      date.setDate(date.getDate() + daysOffset);
      document.getElementById("datum").value = date.toISOString().split("T")[0];
      isDirty = true;
    }

    function clearForm() {
      if (!confirm("Opravdu chcete vymazat všechny položky? Tato akce se nedá vrátit.")) return;
      document.getElementById("entries").innerHTML = "";
      itemCounter = 0;
      addFoodItem();
      document.getElementById("result").classList.add("d-none");
      clearDraftData();
      isDirty = false;
      showAlert("Formulář byl vymazán", "info");
    }

    async function handleFormSubmit(event) {
      event.preventDefault();
      if (!validateForm()) return;
      const formData = gatherFormData();
      if (!formData) return;
      await submitData(formData);
    }

    function validateForm() {
      const datum = document.getElementById("datum").value;
      if (!datum) {
        showAlert("Prosím vyberte datum.", "danger");
        document.getElementById("datum").focus();
        return false;
      }
      let isValid = true;
      const entryCards = document.querySelectorAll(".entry-card");
      if (entryCards.length === 0) {
        showAlert("Přidejte alespoň jednu položku!", "warning");
        return false;
      }
      entryCards.forEach((card) => {
        card.querySelectorAll("input, select").forEach((input) => {
          if (!input.checkValidity()) {
            input.classList.add("is-invalid");
            isValid = false;
          } else {
            input.classList.remove("is-invalid");
          }
        });
      });
      if (!isValid) {
        showAlert("Prosím opravte chyby ve formuláři.", "danger");
        const firstError = document.querySelector(".is-invalid");
        if (firstError) {
          firstError.scrollIntoView({ behavior: "smooth", block: "center" });
          firstError.focus();
        }
      }
      return isValid;
    }

    function gatherFormData() {
      const datum = document.getElementById("datum").value;
      const items = [];
      document.querySelectorAll(".entry-card").forEach((card) => {
        const druh_chodu = card.querySelector("select[name='druh_chodu']").value;
        const hmotnost = card.querySelector("input[name='hmotnost']").value;
        const potravina = card.querySelector("input[name='potravina']").value.trim();
        const kaloricka_hodnota = card.querySelector("input[name='kaloricka_hodnota']").value;
        if (potravina && hmotnost && parseFloat(hmotnost) > 0) {
          items.push({
            datum: datum,
            druh_chodu: druh_chodu,
            hmotnost: parseFloat(hmotnost),
            potravina: potravina,
            kaloricka_hodnota: parseFloat(kaloricka_hodnota) || 0,
          });
        }
      });
      if (items.length === 0) {
        showAlert("Žádné platné položky k odeslání!", "warning");
        return null;
      }
      return {
        klient_klic: currentClientKey,
        items: items,
      };
    }

    async function submitData(data) {
      const loadingOverlay = document.getElementById("loading-overlay");
      const submitBtn = document.getElementById("submit-btn");
      try {
        loadingOverlay.classList.remove("d-none");
        submitBtn.disabled = true;
        if (CONFIG.DEBUG) {
          console.log("Odesílám data:", data);
        }
        const response = await fetch(CONFIG.API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });
        const result = await response.json();
        if (result.success) {
          showAlert(`✅ Úspěšně odesláno ${data.items.length} položek!`, "success");
          setTimeout(() => {
            clearForm();
          }, 2000);
          clearDraftData();
          isDirty = false;
        } else {
          throw new Error(result.error || "Neznámá chyba serveru");
        }
      } catch (error) {
        console.error("Chyba při odesílání:", error);
        showAlert(`❌ Chyba při odesílání: ${error.message}`, "danger");
      } finally {
        loadingOverlay.classList.add("d-none");
        submitBtn.disabled = false;
      }
    }

    function showAlert(message, type) {
      const result = document.getElementById("result");
      result.className = `alert alert-${type}`;
      result.innerHTML = `<div class="d-flex align-items-center"><i class="bi bi-${getAlertIcon(type)} me-2"></i><span>${message}</span></div>`;
      result.classList.remove("d-none");
      result.scrollIntoView({ behavior: "smooth", block: "center" });
      if (type === "success") {
        setTimeout(() => {
          result.classList.add("d-none");
        }, 5000);
      }
    }

    function getAlertIcon(type) {
      const icons = {
        success: "check-circle-fill",
        danger: "exclamation-triangle-fill",
        warning: "exclamation-circle-fill",
        info: "info-circle-fill",
      };
      return icons[type] || "info-circle-fill";
    }

    function handleKeyboardShortcuts(e) {
      if (e.ctrlKey && e.key === "Enter") {
        e.preventDefault();
        document.getElementById("food-form").dispatchEvent(new Event("submit"));
      }
      if (e.ctrlKey && e.key === "n") {
        e.preventDefault();
        addFoodItem();
      }
      if (e.ctrlKey && e.shiftKey && e.key === "C") {
        e.preventDefault();
        clearForm();
      }
    }

    function startAutoSave() {
      if (autoSaveTimer) clearTimeout(autoSaveTimer);
      autoSaveTimer = setTimeout(() => {
        saveDraftData();
      }, CONFIG.AUTO_SAVE_INTERVAL);
    }

    function saveDraftData() {
      try {
        const formData = gatherFormData();
        if (formData) {
          localStorage.setItem(
            `draft_${currentClientKey}`,
            JSON.stringify({
              ...formData,
              datum: document.getElementById("datum").value,
              timestamp: new Date().toISOString(),
            })
          );
          if (CONFIG.DEBUG) {
            console.log("Draft uložen");
          }
        }
      } catch (error) {
        console.error("Chyba při ukládání draftu:", error);
      }
    }

    function loadDraftData() {
      try {
        const draftKey = `draft_${currentClientKey}`;
        const draftData = localStorage.getItem(draftKey);
        if (draftData) {
          const data = JSON.parse(draftData);
          const draftAge = new Date() - new Date(data.timestamp);
          if (draftAge < 24 * 60 * 60 * 1000) {
            if (confirm("Byl nalezen neuložený draft. Chcete ho obnovit?")) {
              restoreDraftData(data);
            } else {
              clearDraftData();
            }
          } else {
            clearDraftData();
          }
        }
      } catch (error) {
        console.error("Chyba při načítání draftu:", error);
        clearDraftData();
      }
    }

    function restoreDraftData(data) {
      document.getElementById("datum").value = data.datum;
      document.getElementById("entries").innerHTML = "";
      itemCounter = 0;

      data.items.forEach((item) => {
        addFoodItem();
        const lastCard = document.querySelector(".entry-card:last-child");
        lastCard.querySelector("select[name='druh_chodu']").value = item.druh_chodu;
        lastCard.querySelector("input[name='hmotnost']").value = item.hmotnost;
        lastCard.querySelector("input[name='potravina']").value = item.potravina;
        lastCard.querySelector("input[name='kaloricka_hodnota']").value = item.kaloricka_hodnota;
      });

      showAlert("Draft byl obnoven", "info");
      isDirty = false;
    }

    function clearDraftData() {
      localStorage.removeItem(`draft_${currentClientKey}`);
    }
  </script>
</body>
</html>

